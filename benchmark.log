Configuring for 8 CPU threads
Using device: cpu
Model device: cpu
Input IDs device: cpu
Attention Mask device: cpu
Device set to use cpu
Device set to use cpu

Running CPU inference benchmarks...
--------------------------------------------------
Warming up models...

Model type: <class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'>
Model dtype: torch.float32

Model type: <class 'src.models.modelling_llama_skip.LlamaSkipConnectionForCausalLM'>
Model dtype: torch.float32

Model type: <class 'src.models.modelling_llama_skip.LlamaSkipConnectionForCausalLM'>
Model dtype: torch.float32

Model type: <class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'>
Model dtype: torch.float32

SkipLLaMA Scripted MLP CPU Results:
Average time: 0.008s
Min time: 0.007s
Max time: 0.032s
Individual times: ['0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.008s', '0.011s', '0.008s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.009s', '0.008s', '0.008s', '0.008s', '0.008s', '0.007s', '0.007s', '0.008s', '0.008s', '0.007s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.008s', '0.007s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.007s', '0.007s', '0.007s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.007s', '0.007s', '0.007s', '0.008s', '0.008s', '0.007s', '0.008s', '0.007s', '0.008s', '0.007s', '0.008s', '0.008s', '0.008s', '0.008s', '0.007s', '0.008s', '0.007s', '0.009s', '0.007s', '0.008s', '0.007s', '0.007s', '0.007s', '0.007s', '0.008s', '0.007s', '0.008s', '0.007s', '0.008s', '0.008s', '0.007s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.008s', '0.028s', '0.011s', '0.032s']

Standard LLaMA MLP CPU Results:
Average time: 0.028s
Min time: 0.019s
Max time: 0.204s
Individual times: ['0.053s', '0.046s', '0.046s', '0.140s', '0.204s', '0.200s', '0.043s', '0.035s', '0.035s', '0.105s', '0.042s', '0.045s', '0.033s', '0.033s', '0.032s', '0.032s', '0.175s', '0.179s', '0.194s', '0.020s', '0.021s', '0.019s', '0.020s', '0.020s', '0.019s', '0.019s', '0.020s', '0.020s', '0.020s', '0.020s', '0.019s', '0.020s', '0.019s', '0.020s', '0.019s', '0.020s', '0.020s', '0.019s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.019s', '0.019s', '0.020s', '0.020s', '0.020s', '0.020s', '0.019s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.019s', '0.020s', '0.020s', '0.019s', '0.020s', '0.020s', '0.020s', '0.020s', '0.019s', '0.021s', '0.019s', '0.019s', '0.019s', '0.019s', '0.020s', '0.019s', '0.020s', '0.020s', '0.019s', '0.019s', '0.020s', '0.020s', '0.020s', '0.019s', '0.019s', '0.019s', '0.020s', '0.019s', '0.019s', '0.020s', '0.020s', '0.020s', '0.020s', '0.019s', '0.020s', '0.019s', '0.020s', '0.019s', '0.020s', '0.020s', '0.020s', '0.020s', '0.019s', '0.020s', '0.020s', '0.020s', '0.019s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.019s', '0.020s', '0.020s', '0.020s', '0.019s', '0.019s', '0.020s', '0.019s', '0.020s', '0.019s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.020s', '0.019s', '0.020s', '0.020s', '0.020s', '0.020s', '0.019s', '0.019s', '0.020s', '0.019s', '0.019s', '0.021s', '0.019s', '0.020s', '0.020s', '0.019s', '0.020s', '0.019s', '0.019s', '0.019s', '0.019s', '0.019s', '0.019s', '0.019s', '0.019s', '0.020s', '0.019s', '0.019s', '0.020s', '0.020s', '0.019s']

SkipLLaMA Scripted CPU Results:
Average time: 0.712s
Min time: 0.641s
Max time: 1.233s
Individual times: ['0.653s', '0.657s', '0.649s', '0.643s', '0.642s', '0.641s', '0.648s', '0.642s', '1.233s']

Standard LLaMA CPU Results:
Average time: 1.469s
Min time: 1.170s
Max time: 3.742s
Individual times: ['3.742s', '1.185s', '1.184s', '1.182s', '1.178s', '1.186s', '1.212s', '1.183s', '1.170s']

CPU Speedups:
Scripted vs Standard: 2.06x