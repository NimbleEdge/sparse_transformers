Configuring for 8 CPU threads
Using device: cpu
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.07it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.26it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.23it/s]
Device set to use cpu
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.14it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.28it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:01<00:00,  1.26it/s]
Device set to use cpu

Running CPU inference benchmarks...
--------------------------------------------------
Warming up models...

Model type: <class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'>
Model dtype: torch.float32
Model path: meta-llama/Llama-3.2-3B-Instruct

Model type: <class 'src.models.modelling_llama_skip.LlamaSkipConnectionForCausalLM'>
Model dtype: torch.float32
Model path: meta-llama/Llama-3.2-3B-Instruct

Model type: <class 'src.models.modelling_llama_skip.LlamaSkipConnectionForCausalLM'>
Model dtype: torch.float32
Model path: meta-llama/Llama-3.2-3B-Instruct

Model type: <class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'>
Model dtype: torch.float32
Model path: meta-llama/Llama-3.2-3B-Instruct

SkipLLaMA Scripted CPU Results:
Average time: 1.095s
Min time: 0.741s
Max time: 4.726s
Individual times: ['0.741s', '0.745s', '0.743s', '0.750s', '0.747s', '0.754s', '0.747s', '0.764s', '0.750s', '0.749s', '0.754s', '0.749s', '0.826s', '0.818s', '4.554s', '2.593s', '0.750s', '0.753s', '0.762s', '0.755s', '0.751s', '0.748s', '0.748s', '0.747s', '0.753s', '0.749s', '0.750s', '0.763s', '0.750s', '0.750s', '0.754s', '4.504s', '2.750s', '0.747s', '0.747s', '0.756s', '0.749s', '0.750s', '0.750s', '0.749s', '0.748s', '0.745s', '0.743s', '0.745s', '0.747s', '0.748s', '0.753s', '0.850s', '2.362s', '4.726s']

Standard LLaMA CPU Results:
Average time: 1.824s
Min time: 1.095s
Max time: 6.964s
Individual times: ['1.250s', '1.270s', '1.264s', '1.262s', '1.255s', '1.254s', '1.253s', '1.267s', '1.258s', '5.293s', '2.864s', '1.270s', '1.259s', '1.266s', '1.261s', '1.257s', '1.258s', '1.262s', '1.302s', '4.796s', '3.514s', '1.111s', '1.097s', '1.119s', '1.095s', '1.360s', '1.266s', '1.265s', '1.260s', '1.268s', '6.200s', '2.175s', '1.487s', '1.483s', '1.497s', '1.486s', '1.493s', '1.490s', '1.362s', '6.964s', '1.544s', '1.255s', '1.255s', '1.250s', '1.249s', '1.250s', '1.256s', '1.252s', '1.257s', '5.239s']

CPU Speedups:
Scripted vs Standard: 1.67x
